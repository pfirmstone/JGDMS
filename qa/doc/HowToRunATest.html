<!--
 ! Licensed to the Apache Software Foundation (ASF) under one
 ! or more contributor license agreements.  See the NOTICE file
 ! distributed with this work for additional information
 ! regarding copyright ownership. The ASF licenses this file
 ! to you under the Apache License, Version 2.0 (the
 ! "License"); you may not use this file except in compliance
 ! with the License. You may obtain a copy of the License at
 ! 
 !      http://www.apache.org/licenses/LICENSE-2.0
 ! 
 ! Unless required by applicable law or agreed to in writing, software
 ! distributed under the License is distributed on an "AS IS" BASIS,
 ! WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 ! See the License for the specific language governing permissions and
 ! limitations under the License.
 !-->
<HTML>
<HEAD>
<TITLE>How to Run a QA Test</TITLE>
</HEAD>
<BODY>
  <CENTER>
    <H1>How to Run a QA Test</H1>
    <H3>Author: Steven F. Harris</H3>
    <H3>Date: December 1, 1999</H3>
  </CENTER>

  <UL

  <LI><H3>Introduction</H3></LI>
  <P>
  This document explains in step by step fashion how to run Jini QA
  tests. A Jini QA test is a class that implements the
  org.apache.river.tck.harness.Test interface and is thus able to run inside of
  the TCK (Technology Compatibility Kit) test harness. In general, a Jini
  QA test will test either a service (such as Lookup Discovery Service) or
  a utility (such as Client Lookup Manager or Join Manager). For more
  information refer to the "How to Write a Test" document. 
  </P>

  <LI><H3>Required software</H3></LI>
  <P>
  In order to run tests you will need access to an installation of TCK 1.0B
  as well as the QA Methodology Framework software. There is an
  installation of TCK 1.0B located in the installation directory
  /net/jini/files/web/qa/tck/jinitck1_0B. Alternatively, you may install
  the TCK software on your own drive and use that. You will need to start
  up rmid (if your tests require it) as the framework will not do this for
  you. The Runner (the TCK test harness) starts up a class server on port
  8080 which serves up class files from the TCK's /lib directory under the
  installation directory. It is essential that any class server that you
  start use a port number other than 8080 otherwise, the harness will throw
  an exception. The QA Methodology Framework software is located in
  /vob/qa/jars/QATestUtil.jar. You may need to perform a gmake on the qa
  vob if you have not already done so. In order to successfully perform a
  build in the <CODE>qa</CODE> vob you must have previously performed
  successful builds in the <CODE>jive</CODE> and <CODE>tck</CODE> vobs.
  </P>

  <LI><H3>Setting up and testing the environment</H3></LI>
  <P>
  <OL>
  <LI>Ensure that you have access to the required software as described
  above.</LI> <LI>Start up rmid</LI> 

  <LI>Start up a class server to serve up the Jini jars (core, ext, etc...)
  in directory /vob/jive/lib on port 8085</LI>

  <LI>Copy the contents of /vob/qa/src/org/apache/river/qa/harness/resource
  to some convenient directory.<BR>For the purposes of these instructions
  we will assume <CODE>$HOME/qatest</CODE>.</LI>

  <LI>cd to <CODE>$HOME/qatest</CODE> if you are not already there.</LI>

  <LI>Enter the command
  <CODE>/vob/qa/src/org/apache/river/qa/harness/examples/run_sampleutilitytest
  </CODE></LI>
  <P>
  The qatest.prop file that you copied to the $HOME/qatest directory has a
  property called qatest.debug which is set to true. This causes additional
  output to be generated by the framework when starting and stopping
  services. This extra information is useful for debugging purposes. You
  can stop this output by either commenting out the assignment of the
  qatest.debug property or by setting the value of the qatest.debug
  property to false. 
  </P>
  <P>
  At the end of the output you should see the following text:
  <PRE>
  Test Passed: Success -> Proxy joined lookups as expected.
  </PRE>
  </P>
  <LI>Enter the command
  <CODE>/vob/qa/src/org/apache/river/qa/harness/examples/run_sampleservicetest
  </CODE></LI>
  <P>
  At the end of the output you should see the following text:
  <PRE>
  Test Passed: Success -> Transaction isolation is verified.
  </PRE>
  </P>

  </OL>
  </P>

  <LI><H3>The <CODE>run_qatest</CODE> shell script</H3></LI>
  <P>
  The <CODE>run_qatest</CODE> shell script is provided to help make running
  Jini QA test easier. The usage statement for the script follows:
  <PRE>
  Usage run_qatest -tests -categories [-prop -policy -cp -jdk]
  </PRE>
  <UL>
  <LI>-tests is the comma delimited list of tests to be run</LI>
  <LI>-categories is the comma delimited list of test categories</LI>
  <LI>-prop is the path of the propery file</LI>
  <LI>-policy is the path of the policy file</LI>
  <LI>-cp is extra classpath directories to append to default</LI>
  <LI>-jdk is the fully specified path to java.exe</LI>
  </UL>
  For example to run the SampleUtilityTest example use the command:
  <PRE>
  qatest -test org.apache.river.test.harness.examples.ServiceUtilityTest 
         -categories joinmanager
  </PRE>
  </P>
  In practice, if you plan to override many of the defaults, you will want
  to create your own shell script wrappers. See the run_sampleutilitytest
  and run_sampleservicetest scripts for examples.
  <P>

  <LI><H3>Step by step procedure for running a test</H3></LI>
  <P>
  The following procedure assumes that the environment has been set up
  correctly and <CODE>rmid</CODE> and a class server are running. It also
  assumes that your test(s) are compiled and reside under /vob/qa/classes
  </P>
  <P>
  <OL>

  <LI>Create a Properties file for your test(s). You may
  create one Properties file for each test or use one for all your tests. See
  /vob/qa/src/org/apache/river/qa/harness/examples/sampletest.prop for an 
  example.</LI>  

  <LI>Edit the qatest.prop file in $HOME/qatest and add a line to the end
  that maps your Properties file to a specific test. You must add one such
  line for each test. qatest.prop shows examples using SampleUtilityTest
  and SampleServiceTest.</LI>

  <LI>Edit the properties file and include argument information for the
  services that your test(s) will need to start. Also see
  /vob/qa/src/org/apache/river/qa/harness/examples/sampletest.prop for an
  example.</LI> 

  <LI>cd to <CODE>$HOME/qatest</CODE> if you are not already there.</LI>

  <LI>Execute the command:
  <PRE>
  run_qatest -tests org.apache.river.test.myarea.MyTest -categories myCategory 
             -cp /vob/qa/classes
  </PRE>
  You may also define any parameters that you might put in a Properties
  file on the command line. For example:
  <PRE>
  run_qatest -tests org.apache.river.test.myarea.MyTest -categories myCategory 
             -cp /vob/qa/classes -qautil.debug true
  </PRE>
  Will turn on debugging information in the QA Methodology Framework code.
  </LI>
  </OL>  
  </P>

</BODY>
</HMTL>









